(function(d,g){var b;d.rails=b={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote]",selectChangeSelector:"select[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled", requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input:file",CSRFProtection:function(a){var c=d('meta[name="csrf-token"]').attr("content");c&&a.setRequestHeader("X-CSRF-Token",c)},fire:function(a,c,b){c=d.Event(c);a.trigger(c,b);return c.result!==false},confirm:function(a){return confirm(a)},ajax:function(a){return d.ajax(a)},handleRemote:function(a){var c,h,e,f=a.data("cross-domain")||null,j=a.data("type")||d.ajaxSettings&& d.ajaxSettings.dataType;if(b.fire(a,"ajax:before")){if(a.is("form")){c=a.attr("method");h=a.attr("action");e=a.serializeArray();var i=a.data("ujs:submit-button");i&&(e.push(i),a.data("ujs:submit-button",null))}else a.is("select")?(c=a.data("method"),h=a.data("url"),e=a.serialize(),a.data("params")&&(e=e+"&"+a.data("params"))):(c=a.data("method"),h=a.attr("href"),e=a.data("params")||null);options={type:c||"GET",data:e,dataType:j,crossDomain:f,beforeSend:function(c,d){d.dataType===g&&c.setRequestHeader("accept", "*/*;q=0.5, "+d.accepts.script);return b.fire(a,"ajax:beforeSend",[c,d])},success:function(c,b,d){a.trigger("ajax:success",[c,b,d])},complete:function(c,b){a.trigger("ajax:complete",[c,b])},error:function(c,b,d){a.trigger("ajax:error",[c,b,d])}};h&&d.extend(options,{url:h});b.ajax(options)}},handleMethod:function(a){var c=a.attr("href"),b=a.data("method"),a=d("meta[name=csrf-token]").attr("content"),e=d("meta[name=csrf-param]").attr("content"),c=d('<form method="post" action="'+c+'"></form>'),b='<input name="_method" value="'+ b+'" type="hidden" />';e!==g&&a!==g&&(b+='<input name="'+e+'" value="'+a+'" type="hidden" />');c.hide().append(b).appendTo("body");c.submit()},disableFormElements:function(a){a.find(b.disableSelector).each(function(){var a=d(this),b=a.is("button")?"html":"val";a.data("ujs:enable-with",a[b]());a[b](a.data("disable-with"));a.attr("disabled","disabled")})},enableFormElements:function(a){a.find(b.enableSelector).each(function(){var a=d(this),b=a.is("button")?"html":"val";if(a.data("ujs:enable-with"))a[b](a.data("ujs:enable-with")); a.removeAttr("disabled")})},allowAction:function(a){var c=a.data("confirm"),d=false,e;if(!c)return true;b.fire(a,"confirm")&&(d=b.confirm(c),e=b.fire(a,"confirm:complete",[d]));return d&&e},blankInputs:function(a,c,b){var e=d(),f;a.find(c||"input,textarea").each(function(){f=d(this);if(b?f.val():!f.val())e=e.add(f)});return e.length?e:false},nonBlankInputs:function(a,c){return b.blankInputs(a,c,true)},stopEverything:function(a){d(a.target).trigger("ujs:everythingStopped");a.stopImmediatePropagation(); return false},callFormSubmitBindings:function(a){var a=a.data("events"),b=true;a!==g&&a.submit!==g&&d.each(a.submit,function(a,d){if(typeof d.handler==="function")return b=d.handler(d.data)});return b}};d.ajaxPrefilter(function(a,c,d){a.crossDomain||b.CSRFProtection(d)});d(b.linkClickSelector).live("click.rails",function(a){var c=d(this);if(!b.allowAction(c))return b.stopEverything(a);if(c.data("remote")!==g)return b.handleRemote(c),false;else if(c.data("method"))return b.handleMethod(c),false}); d(b.selectChangeSelector).live("change.rails",function(a){var c=d(this);if(!b.allowAction(c))return b.stopEverything(a);b.handleRemote(c);return false});d(b.formSubmitSelector).live("submit.rails",function(a){var c=d(this),h=c.data("remote")!==g,e=b.blankInputs(c,b.requiredInputSelector),f=b.nonBlankInputs(c,b.fileInputSelector);if(!b.allowAction(c))return b.stopEverything(a);if(e&&b.fire(c,"ajax:aborted:required",[e]))return b.stopEverything(a);if(h){if(f)return b.fire(c,"ajax:aborted:file",[f]); if(!d.support.submitBubbles&&b.callFormSubmitBindings(c)===false)return b.stopEverything(a);b.handleRemote(c);return false}else setTimeout(function(){b.disableFormElements(c)},13)});d(b.formInputClickSelector).live("click.rails",function(a){var c=d(this);if(!b.allowAction(c))return b.stopEverything(a);a=(a=c.attr("name"))?{name:a,value:c.val()}:null;c.closest("form").data("ujs:submit-button",a)});d(b.formSubmitSelector).live("ajax:beforeSend.rails",function(a){this==a.target&&b.disableFormElements(d(this))}); d(b.formSubmitSelector).live("ajax:complete.rails",function(a){this==a.target&&b.enableFormElements(d(this))})})(jQuery);