Raphael.fn.drawGrid=function(l,b,i,a,r,j,m){for(var m=m||"#000",n=["M",Math.round(l)+0.5,Math.round(b)+0.5,"L",Math.round(l+i)+0.5,Math.round(b)+0.5,Math.round(l+i)+0.5,Math.round(b+a)+0.5,Math.round(l)+0.5,Math.round(b+a)+0.5,Math.round(l)+0.5,Math.round(b)+0.5],u=a/j,e=i/r,k=1;k<j;k++)n=n.concat(["M",Math.round(l)+0.5,Math.round(b+k*u)+0.5,"H",Math.round(l+i)+0.5]);for(k=1;k<r;k++)n=n.concat(["M",Math.round(l+k*e)+0.5,Math.round(b)+0.5,"V",Math.round(b+a)+0.5]);return this.path(n.join(",")).attr({stroke:m})}; jQuery.noConflict();jQuery(function(){jQuery("#data").css({position:"absolute",left:"-9999em",top:"-9999em"})}); window.onload=function(){function l(a,e,c,d,b,h){var f=(c-a)/2,g=(b-c)/2,a=Math.atan((c-a)/Math.abs(d-e)),b=Math.atan((b-c)/Math.abs(d-h)),a=e<d?Math.PI-a:a,b=h<d?Math.PI-b:b,h=Math.PI/2-(a+b)%(Math.PI*2)/2,e=f*Math.sin(h+a);f*=Math.cos(h+a);a=g*Math.sin(h+b);g*=Math.cos(h+b);return{x1:c-e,y1:d+f,x2:c+a,y2:d+g}}var b=[],i=[];jQuery("#data tfoot th").each(function(){b.push(jQuery(this).html())});jQuery("#data tbody td").each(function(){i.push(jQuery(this).html())});var a=Raphael("holder",550,250), r={font:"12px Helvetica, Arial",fill:"#fff"},j=550/b.length,m=210/Math.max.apply(Math,i);a.drawGrid(j*0.5+0.5,20.5,550-j,210,10,10,"#000");var n=a.path().attr({stroke:"#0069D6","stroke-width":4,"stroke-linejoin":"round"}),u=a.path().attr({stroke:"#0069D6",opacity:0.3,fill:"#0069D6"}),e=a.set(),k=0,v=0,s=false,w,t=a.set();e.push(a.text(60,12,"24 hits").attr(r));e.push(a.text(60,27,"22 September 2008").attr({font:"10px Helvetica, Arial",fill:"#000"}).attr({fill:"#0069D6"}));e.hide();for(var o=a.popup(100, 100,e,"right").attr({fill:"#000",stroke:"#666","stroke-width":2,"fill-opacity":0.7}).hide(),p,q,c=0,x=b.length;c<x;c++){var f=Math.round(230-m*i[c]),d=Math.round(0+j*(c+0.5));a.text(d,244,b[c]).attr(r).toBack();c||(p=["M",d,f,"C",d,f],q=["M",0+j*0.5,230,"L",d,f,"C",d,f]);if(c&&c<x-1){var g=Math.round(230-m*i[c-1]),y=Math.round(0+j*(c-0.5)),z=Math.round(230-m*i[c+1]),A=Math.round(0+j*(c+1.5)),g=l(y,g,d,f,A,z);p=p.concat([g.x1,g.y1,d,f,g.x2,g.y2]);q=q.concat([g.x1,g.y1,d,f,g.x2,g.y2])}g=a.circle(d, f,4).attr({fill:"#333",stroke:"#0069D6","stroke-width":2});t.push(a.rect(0+j*c,0,j,230).attr({stroke:"none",fill:"#fff",opacity:0}));var B=t[t.length-1];(function(b,c,d,f,g){B.hover(function(){clearTimeout(w);var h="right";b+o.getBBox().width>550&&(h="left");var h=a.popup(b,c,e,h,1),i=Raphael.animation({path:h.path,transform:["t",h.dx,h.dy]},200*s);k=e[0].transform()[0][1]+h.dx;v=e[0].transform()[0][2]+h.dy;o.show().stop().animate(i);e[0].attr({text:d+""}).show().stop().animateWith(o,i,{transform:["t", k,v]},200*s);e[1].attr({text:f+""}).show().stop().animateWith(o,i,{transform:["t",k,v]},200*s);g.attr("r",6);s=true},function(){g.attr("r",4);w=setTimeout(function(){o.hide();e[0].hide();e[1].hide();s=false},1)})})(d,f,i[c],b[c],g)}p=p.concat([d,f,d,f]);q=q.concat([d,f,d,f,"L",d,230,"z"]);n.attr({path:p});u.attr({path:q});o.toFront();e[0].toFront();e[1].toFront();t.toFront()};