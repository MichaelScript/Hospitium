<div class="row-fluid">
	<div class="span12">
		<% if notice.blank? %>

		<% else %>
			<div class="alert alert-info"><a class="close" data-dismiss="alert" href="#">&times;</a> <%= notice %></div>
		<% end %>
		<div class="well">
			<h1>Dashboard</h1>
		</div>
		<div class="row-fluid">
			<div class="span12">
				<h2>Animal Statuses</h2>
				<div id="chart1" style="height: 300px; width: 500px; float:left; " class="jqplot-target"></div>
				<div class="barchart">
					<ul class="timelineAnimal">
						<% @final_status_hash['bar'].each do |key, value| %>
							<li class="barAnimal"><a href="#">
								<span class="labelAnimal"><%= key + " count: " + value["count"]%></span>
								<span class="countAnimal tooltip-class" data-animate-length="<%= number_to_percentage(value["percent"], :precision => 0)%>" style="height: 2%;opacity:0;" title="<%= value["count"] %>"><%= value["count"] %></span>
							</a></li>
						<%end%>
					</ul>
					<ul class="chartKey-bar"></ul>
				</div>
			</div>
		</div>

		<div class="row-fluid">
			<div class="span12">
				<h2>Animal Species</h2>
				<div id="chart2" style="height: 300px; width: 500px; float:left; " class="jqplot-target"></div>
				<div class="barchart">
					<ul class="timelineAnimal">
						<% @final_species_hash['bar'].each do |key, value| %>
							<li class="barAnimal"><a href="#">
								<span class="labelAnimal"><%= key + " count: " + value["count"]%></span>
								<span class="countAnimal tooltip-class" data-animate-length="<%= number_to_percentage(value["percent"], :precision => 0)%>" style="height: 2%;opacity:0;" title="<%= value["count"] %>"><%= value["count"] %></span>
							</a></li>
						<%end%>
					</ul>
					<ul class="chartKey-bar"></ul>
				</div>
			</div>
		</div>
		<hr />
		<div class="row-fluid">
			<div class="span12">
				<h2>Recent Tweets</h2>
				<table class="table table-striped table-bordered">
					<thead>
						<th>User</th>
						<th>Tweet</th>
					</thead>
					<tbody>
						<% @tweets.each do |tweet| %>
							<tr>
								<td><%= tweet.user.name %></td>
								<td><%= tweet.text %></td>
							</tr>
						<%end%>
					</tbody>
				</table>
			</div>
		</div>

		<% content_for :javascript_footer do %>
			
			<script>
				$(document).ready(function(){
					var data = <%= raw(@final_status_hash['pie'].to_json) %>;
					var plot1 = jQuery.jqplot ('chart1', [data], { 
						grid: {
		            drawBorder: false,
		            drawGridlines: false,
		            background: 'none',
		            shadow:false
		        },
						seriesColors: [ "#006DCC", "#49AFCD", "#5BB75B", "#FAA732", "#DA4F49", "#ff6138",
						        "#ffff9d", "#beeb9f", "#79bd8f", "#00a387", "#0085cc"],
						seriesDefaults: {
							// Make this a pie chart.
							renderer: jQuery.jqplot.PieRenderer, 
							rendererOptions: {
								// Put data labels on the pie slices.
								// By default, labels show the percentage of the slice.
								diameter: 190,
								sliceMargin: 8,
								showDataLabels: false
							}
						}, 
						legend: { show:true, location: 'e' }
					}
					);
				});
				
				$(document).ready(function(){
					var data2 = <%= raw(@final_species_hash['pie'].to_json) %>;
					var plot2 = jQuery.jqplot ('chart2', [data2], { 
						grid: {
		            drawBorder: false,
		            drawGridlines: false,
		            background: 'none',
		            shadow:false
		        },
						seriesColors: [ "#006DCC", "#49AFCD", "#5BB75B", "#FAA732", "#DA4F49", "#ff6138",
						        "#ffff9d", "#beeb9f", "#79bd8f", "#00a387", "#0085cc"],
						seriesDefaults: {
							// Make this a pie chart.
							renderer: jQuery.jqplot.PieRenderer, 
							rendererOptions: {
								// Put data labels on the pie slices.
								// By default, labels show the percentage of the slice.
								diameter: 190,
								sliceMargin: 8,
								showDataLabels: false
							}
						}, 
						legend: { show:true, location: 'e' }
					}
					);
					
					
					$('#chart1').bind('jqplotDataHighlight', function (ev, seriesIndex, pointIndex, data ) {
						//alert(data[0]);
						//$("td:contains('"+data[0]+"')").css("text-decoration", "underline");
						$("span:contains('"+data[0]+"')").css("font-weight", "600");
						$("span:contains('"+data[0]+"')").attr("data-highlight-chart-key", "true");
						$("span:contains('"+data[0]+"')").parent().find('div.jqplot-table-legend-swatch').css("box-shadow", "0 0 5px #333");
					});    
				
					$('#chart1').bind('jqplotDataUnhighlight', function (ev, seriesIndex, pointIndex, data) {
						var highlighted = $("li").find("[data-highlight-chart-key='true']");
						highlighted.css("font-weight", "400");
						highlighted.parent().find('div.jqplot-table-legend-swatch').css("box-shadow", "0 0 0px #333");
						highlighted.removeAttr("data-highlight-chart-key");
					});
					
					$('#chart2').bind('jqplotDataHighlight', function (ev, seriesIndex, pointIndex, data ) {
						//alert(data[0]);
						//$("td:contains('"+data[0]+"')").css("text-decoration", "underline");
						$("span:contains('"+data[0]+"')").css("font-weight", "600");
						$("span:contains('"+data[0]+"')").attr("data-highlight-chart-key", "true");
						$("span:contains('"+data[0]+"')").parent().find('div.jqplot-table-legend-swatch').css("box-shadow", "0 0 5px #333");
					});    
				
					$('#chart2').bind('jqplotDataUnhighlight', function (ev, seriesIndex, pointIndex, data) {
						var highlighted = $("li").find("[data-highlight-chart-key='true']");
						highlighted.css("font-weight", "400");
						highlighted.parent().find('div.jqplot-table-legend-swatch').css("box-shadow", "0 0 0px #333");
						highlighted.removeAttr("data-highlight-chart-key");
					});
					
					
				});
			</script>
		<% end %>
	</div>
</div>